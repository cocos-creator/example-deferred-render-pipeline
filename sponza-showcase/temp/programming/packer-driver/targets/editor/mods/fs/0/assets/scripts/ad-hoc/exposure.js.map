{"version":3,"sources":["file:///D:/Deferred_RenderPipeline/sponza-showcase/assets/scripts/ad-hoc/exposure.ts"],"names":["_decorator","Component","CameraComponent","director","ccclass","property","Exposure","start","scene","node","pipeline","root","_ambient","ambient","_camera","getComponentInChildren","camera","setSkyIllumination","e","skyIllum","Math","pow","progress","setExposure","aperture","floor"],"mappings":";;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAmDC,MAAAA,e,OAAAA,e;AAAiBC,MAAAA,Q,OAAAA,Q;;;;;;;OACnF;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;0BAGjBM,Q,WADZF,OAAO,CAAC,UAAD,C,yBAAR,MACaE,QADb,SAC8BL,SAD9B,CACwC;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAKpCM,QAAAA,KAAK,GAAI;AACL,gBAAMC,KAAK,GAAG,KAAKC,IAAL,CAAUD,KAAxB;AACA,gBAAME,QAAQ,GAAGP,QAAQ,CAACQ,IAAT,CAAcD,QAA/B;AACA,eAAKE,QAAL,GAAgBF,QAAQ,CAACG,OAAzB;AACA,eAAKC,OAAL,GAAeN,KAAK,CAACO,sBAAN,CAA6Bb,eAA7B,EAA8Cc,MAA7D;AACH;;AAEDC,QAAAA,kBAAkB,CAAEC,CAAF,EAAsB;AACpC,eAAKN,QAAL,CAAcO,QAAd,GAAyBC,IAAI,CAACC,GAAL,CAAS,CAAT,EAAYH,CAAC,CAACI,QAAF,GAAa,KAAzB,CAAzB,CADoC,CACsB;AAC7D;;AAEDC,QAAAA,WAAW,CAAEL,CAAF,EAAsB;AAC7B,eAAKJ,OAAL,CAAaU,QAAb,GAAwBJ,IAAI,CAACK,KAAL,CAAW,CAAC,IAAIP,CAAC,CAACI,QAAP,IAAmB,KAA9B,CAAxB,CAD6B,CACiC;AACjE;;AAlBmC,O","sourcesContent":["import { _decorator, Component, Node, Scene, renderer, SliderComponent, CameraComponent, director } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Exposure')\r\nexport class Exposure extends Component {\r\n\r\n    private _ambient: renderer.Ambient;\r\n    private _camera: renderer.Camera;\r\n\r\n    start () {\r\n        const scene = this.node.scene as Scene;\r\n        const pipeline = director.root.pipeline;\r\n        this._ambient = pipeline.ambient;\r\n        this._camera = scene.getComponentInChildren(CameraComponent).camera;\r\n    }\r\n\r\n    setSkyIllumination (e: SliderComponent) {\r\n        this._ambient.skyIllum = Math.pow(2, e.progress * 30.46); // default illum 38400, at progress 0.5\r\n    }\r\n\r\n    setExposure (e: SliderComponent) {\r\n        this._camera.aperture = Math.floor((1 - e.progress) * 22.99); // defaul aperture F16, at progress 0.17\r\n    }\r\n}\r\n"]}